<!DOCTYPE html>

<title>ELITR Online Text Flow</title>

<style>
  .row {
    display: flex;
    flex-direction: row;
    justify-content: space-evenly;
  }

  .column {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .flash {
    background-color: orange;
    color: white;
    font-family: sans serif;
  }

  a {
    text-decoration: none;
  }

  img {
    display: block;
  }
</style>

{% with messages = get_flashed_messages() %}
{% if messages %}
<div id="flash" class="flash row">
  <div class="flash column">
    {% for message in messages %}
    <div>{{ message }}</div>
    {% endfor %}
  </div>
</div>
{% endif %}
{% endwith %}

<div class="row">
  <div class="column">
    <h1>ELITR <a href="https://github.com/ELITR/online-text-flow">Online Text Flow</a></h1>
    <form action="{{ login }}" method="POST">
      <div>
        <input type="username" name="user" placeholder="username">
        <input type="password" name="pass" placeholder="password">
        <input type="submit" value="Log In">
      </div>
    </form>
  </div>
  <div class="column">
    <a href="https://elitr.eu/">
      <img src="https://elitr.eu/wp-content/uploads/2019/01/logo-elitr-300x268.png" width="300" height="268">
    </a>
  </div>
</div>

<script>
  setTimeout(function () {
      elem = document.getElementById("flash");
      if (elem) {
        elem.style.display = "none";
      }
    }, 2000);
</script>

<!-- Try to login automatically -->
<script>
  function parseGETParams() {
      let queryString = window.location.search.substring(1)

      let params = {}
      let queries = queryString.split("&")

      queries.forEach((indexQuery) => {
          let indexPair = indexQuery.split("=")
          let queryKey = decodeURIComponent(indexPair[0])
          let queryValue = decodeURIComponent(indexPair.length > 1 ? indexPair[1] : "")
          params[queryKey] = queryValue
      })

      return params
  }
  let params = parseGETParams()
  if ('login' in params) {
    let values = params['login'].split(':')
    document.querySelector("[type=username]").value = values[0]
    document.querySelector("[type=password]").value = values[1]
    document.getElementsByTagName("form")[0].submit()
  }
</script>
